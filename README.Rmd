---
author: Lexi Pachonphai
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit the README.Rmd file -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(Lahman)
library(tidyverse)
library(rvest)
library(readr)

url  <- "https://www.baseball-reference.com/awards/hof_2025.shtml"
html <- read_html(url)
tables <- html_table(html, fill = TRUE)
raw2025 <- tables[[1]]
```

# Lab report #4 - instructions

Follow the instructions posted at <https://ds202-at-isu.github.io/labs.html> for the lab assignment. The work is meant to be finished during the lab time, but you have time until Monday (after Thanksgiving) to polish things.

All submissions to the github repo will be automatically uploaded for grading once the due date is passed. Submit a link to your repository on Canvas (only one submission per team) to signal to the instructors that you are done with your submission.

# Lab 4: Scraping (into) the Hall of Fame


```{r echo=FALSE, message=FALSE, warning=FALSE}
hof <- Lahman::HallOfFame
hof %>% 
  ggplot(aes(x = yearID, y = votes/needed*100, group=playerID)) +
  geom_hline(yintercept = 100, colour="grey70") + 
  geom_line() +
  geom_point(aes(colour = "inducted"), 
    data = hof %>% filter(inducted=="Y")) +
  xlim(c(2000, 2022)) +
  ylab("Percent of votes")
```






```{r, message=FALSE}


# fix header row
data2025 <- raw2025
actual_col_names <- as.character(data2025[1, ])
colnames(data2025) <- actual_col_names
data2025 <- data2025[-1, ]          # drop header row

names(data2025) <- make.names(names(data2025), unique = TRUE)

# now Rk, Name, YoB, Votes still exist;
# the "%vote" column has become X.vote

# keep only real player rows
data2025 <- data2025 %>% 
  filter(!is.na(Rk), Rk != "", Name != "")

# clean types
data2025 <- data2025 %>% 
  mutate(
    Votes = parse_number(Votes),
    pct   = parse_number(X.vote),  # was `%vote`
    YoB   = parse_number(YoB)
  )

# build a 2025 data frame that includes player names
ballots_2025 <- 394
needed_2025  <- 296

hof2025 <- data2025 %>% 
  mutate(
    yearID      = 2025L,
    votedBy     = "BBWAA",
    ballots     = ballots_2025,
    needed      = needed_2025,
    inducted    = if_else(Votes >= needed_2025, "Y", "N"),
    category    = "Player",
    needed_note = NA_character_
  ) %>% 
  # rename to nice lower-case names for the CSV
  rename(
    name  = Name,
    votes = Votes
  ) %>% 
  # choose the columns & order you want in the CSV
  select(name, yearID, votedBy, ballots, needed, votes, inducted, category, needed_note)



readr::write_csv(hof2025, "HallOfFame_2025.csv")




hof_all <- bind_rows(hof, hof2025)

hof_all <- hof %>% 
  filter(!(yearID == 2025 & votedBy == "BBWAA" & category == "Player")) %>% 
  bind_rows(hof2025)


```
